import pandas as pd
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler

# Load historical customer data
data = pd.read_csv("customer_data.csv")  # Should include purchase history, engagement, demographics

# Preprocess data
features = ['purchase_frequency', 'average_order_value', 'website_visits']
scaler = StandardScaler()
scaled_data = scaler.fit_transform(data[features])

# Train K-Means clustering model
kmeans = KMeans(n_clusters=4, random_state=42)
data['segment'] = kmeans.fit_predict(scaled_data)

print(data[['customer_id', 'segment']].head())
